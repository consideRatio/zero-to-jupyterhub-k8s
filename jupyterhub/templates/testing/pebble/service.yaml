{{- if .Values.testing.pebble.enabled -}}
apiVersion: v1
kind: Service
metadata:
  name: pebble
  labels:
    {{- include "jupyterhub.labels" . | nindent 4 }}
spec:
  type: ClusterIP
  selector:
    {{- include "jupyterhub.matchLabels" . | nindent 4 }}
  ports:
    - name: acme
      port: 14000
      targetPort: acme
    # The pebble REST api expose endpoints like /roots/0 and /roots-key/0 to get
    # the autogenerated root certificates used to provision certificates to the
    # ACME clients.
    - name: mgmt
      port: 15000
      targetPort: mgmt
{{- end }}
